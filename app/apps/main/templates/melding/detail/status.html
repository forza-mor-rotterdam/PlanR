{% load to_datetime naturalday_with_time_or_timesince from date_tags %}
{% load gebruikersnaam gebruikersinitialen get_gebruiker_object_middels_email from gebruikers_tags %}
{% load humanize %}
{% load mor_core_url from main_tags %}
{% load get taak_status_tekst taak_status_css_class api_url_to_user_url afhandelreden_titel from melding_tags %}
{% load vertaal from vertaal_tags %}

{% if melding.afgesloten_op %}
<section class="section--separated" data-testid="detailTaken">
    <div class="container__details">
        <h2>Status</h2>
        <div class="container__status">
            <div class="container__status--content" data-controller="overflow-toggle" data-overflow-toggle-target="container" data-overflow-toggle-item-class="content__overflow">
                {% comment %}
                    @Maurice De content-containers met Afgehandeld door en Datum en tijd hebben een axtra class cols--2 om een max-width af te dwingen
                    De content-container met het bericht voor de melder heeft een extra class cols--6 om een min-width af te dwingen
                {% endcomment %}
                <div class="container__content cols--2">
                    <h3>Afgehandeld door</h3>
                    <div class="content">
                        <span class="initials">{{ melding.meldinggebeurtenissen.0.gebruiker|get_gebruiker_object_middels_email|gebruikersinitialen }}</span>
                        <div class="message">
                            <h4>{{ melding.meldinggebeurtenissen.0.gebruiker|get_gebruiker_object_middels_email|gebruikersnaam }}</h4>
                        </div>
                    </div>
                </div>
                <div class="container__content">
                    <h3>Reden</h3>
                    <div class="content">
                        <p>
                            {% if melding.afhandelreden %}
                            {{ melding.afhandelreden|afhandelreden_titel }}
                            {% else %}
                            -
                            {% endif %}
                        </p>
                    </div>
                    <h3>Specificatie</h3>
                    <div class="content">
                        <p>
                            {% if melding.specificatie %}
                            {{ melding.specificatie.naam }}
                            {% else %}
                            -
                            {% endif %}
                        </p>
                    </div>
                </div>
                <div class="container__content">
                    <h3>Interne opmerking</h3>
                    <div class="content container__overflow">
                        <p class="content__overflow">
                            {% if melding.meldinggebeurtenissen.0.omschrijving_intern %}
                            {{ melding.meldinggebeurtenissen.0.omschrijving_intern }}
                            {% else %}
                            -
                            {% endif %}
                        </p>
                    </div>
                </div>
                <div class="container__content cols--6">
                    <h3>Bericht voor melder</h3>
                    <div class="content container__overflow">
                        <p class="content__overflow">
                            {{ melding.meldinggebeurtenissen.0.omschrijving_extern }}
                        </p>
                    </div>
                </div>
                <div class="container__content cols--2">
                    <h3>Datum en tijd</h3>
                    <div class="content">
                        <p>{{ melding.afgesloten_op|to_datetime}}</p>
                    </div>
                </div>
                <button type="button"
                    class="btn--clean"
                    data-overflow-toggle-target="toggle"
                    data-action="overflow-toggle#toggle"
                    hidden>
                    {% include "icons/arrow-right.svg" %}
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}
